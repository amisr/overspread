<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/doc_template.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Installing Madrigal for the first time</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
<link href="madrigal.css" rel="stylesheet" type="text/css" />
<!-- InstanceParam name="href_up_top" type="text" value="admin.html" --><!-- InstanceParam name="href_next_top" type="text" value="ad_upgrade.html" --><!-- InstanceParam name="href_back_top" type="text" value="ad_appropriate.html" --><!-- InstanceParam name="href_back_bottom" type="text" value="ad_appropriate.html" --><!-- InstanceParam name="href_up_bottom" type="text" value="admin.html" --><!-- InstanceParam name="href_next_bottom" type="text" value="ad_upgrade.html" --><!-- InstanceParam name="href_prev_top" type="text" value="ad_appropriate.html" --><!-- InstanceParam name="href_uptitle_top" type="text" value="admin.html" --><!-- InstanceParam name="href_nexttitle_top" type="text" value="ad_upgrade.html" --><!-- InstanceParam name="href_prevtitle_bottom" type="text" value="ad_appropriate.html" --><!-- InstanceParam name="href_uptitle_bottom" type="text" value="admin.html" --><!-- InstanceParam name="href_nexttitle_bottom" type="text" value="ad_upgrade.html" -->
</head>

<body>
<table width="100%" border="1" cellpadding="0" cellspacing="2" class="navigation">
  <tr>
    <td width="5%"><a href="ad_appropriate.html"><img src="icons/previous.png" alt="previous" width="32" height="32" /></a></td>
    <td width="5%"><a href="admin.html"><img src="icons/up.png" alt="up" width="32" height="32" /></a></td>
    <td width="5%"><a href="ad_upgrade.html"><img src="icons/next.png" alt="next" width="32" height="32" /></a></td>
    <td width="54%"><!-- InstanceBeginEditable name="EditTitleTop" -->Installing Madrigal for the first time <!-- InstanceEndEditable --></td>
    <td width="13%"><a href="/MADSERVERROOT/madContents.html">Doc home </a></td>
    <td width="18%"><a href="/MADSERVERROOT">Madrigal home</a></td>
  </tr>
</table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" href="ad_appropriate.html"><!-- InstanceBeginEditable name="PreviousTitle" -->Is Madrigal appropriate? <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Up:</b>
<a class="sectref" href="admin.html"><!-- InstanceBeginEditable name="UpTitle" -->Madrigal admin guide <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Next:</b>
<a class="sectref" href="ad_upgrade.html"><!-- InstanceBeginEditable name="NextTitle" -->Upgrading Madrigal <!-- InstanceEndEditable --></A></div>
<hr/>
<!-- InstanceBeginEditable name="EditDoc" -->
<h1 align="center">Installing Madrigal for the first time </h1>
<h4 align="left">Prerequisites</h4>
<p>Most of the prerequisites for Madrigal are pre-installed in any modern unix distribution. They are: </p>
<ol>
  <li>A C  and a FORTRAN  compiler. The free GNU compilers may be downloaded from the <a href="http://www.gnu.org/software/gcc/">GNU Website </a>.</li>
  <li>tclsh, which may be downloaded from the <a href="http://www.tcl.tk/software/tcltk/">Tcl Resource Center </a>. </li>
  <li>The freetype library, available from www.freetype.org.</li>
  <li>A web server. </li>
</ol>
<p>The installation script will stop and issue a warning if any prerequisite is missing. </p>
<h4 align="left">Installation instructions </h4>
<p align="left">Madrigal can be installed on any unix server with a web server. If you want to link your data in with data on other Madrigal servers, please notify the <a href="mailto:madrigal@haystack.mit.edu">OpenMadrigal administrator</a>. In general you do not need root permission to install madrigal once the prerequisites listed above are installed. You may need to be root to create the html and cgi directories in the web server. It is generally easiest to then chown for those two directories to the user that will be installing Madrigal. </p>
<ol>
  <li>Create a directory to be used as your Madrigal root directory on your unix server. This directory will be referred to as MADROOT. </li>
  <li>Create the environment variable MADROOT with that directory path. </li>
  <li>Download the latest Madrigal distribution file, madrigal*.tar.Z from the <a href="http://madrigal.haystack.mit.edu/madrigal/madDownload.html">OpenMadrigal distribution page</a> to MADROOT. </li>
  <li>uncompress madrigal*.tar.Z </li>
  <li>tar -xf madrigal*.tar </li>
  <li>Repeat the 3 steps above to get and untar the Sample Experiments file <em>experiments.tar.Z</em>. </li>
  <li>Create two virtual directories on your webserver for your madrigal cgi files (which must allow scripts to run) and for your madrigal html files. </li>
  <li>In madroot, there will now be a file called madrigal.cfg.template. Copy it to madrigal.cfg, and edit all the configuration parameters, as described in the <a href="#edit">Editing madrigal.cfg</a> section below. </li>
  <li>Edit the file MADROOT/metadata/siteTab.txt with a unique id to include your site. The format of siteTab.txt is described <a href="ad_metadata.html#siteTab">here</a>. If you want to be an official Madrigal site that other Madrigal sites share data with, request the <a href="mailto:madrigal@haystack.mit.edu">OpenMadrigal administrator</a> to assign you this id. If you do not want all the sites in siteTab.txt included in your combined inventory listing, just remove these sites from siteTab.txt. Links to data from sites you leave in the siteTab.txt file will appear in your Madrigal web site. </li>
  <li>Be sure to cd to MADROOT before running the following step. Then you should be able to complete the installation simply by typing <br />
      <pre>bash installMadrigal  &> install.log &</pre>
	   
  There may be a long pause when running updateMaster near the end of the installation since the instParmTab.txt metadata file is being built for the first time by examining every data file, but future calls to updateMaster will be much faster since only new experiments are examined. Help with any installation errors is available from the <a href="mailto:madrigal@haystack.mit.edu">OpenMadrigal administrator</a>. </li>
  <li>If there were no errors, your madrigal installation should be running at the url given by MADSERVERROOT. You can also test it by running MADROOT/bin/python testMadrigalBuild.py, which will test the ability to create plots. </li>
  <li>If you want to receive notices about updates to Madrigal, sign up for the openmadrigal-admin mailing list under www.openmadrigal.org. </li>
  <li>Set the script <em>madroot</em>/bin/updateMaster up as a cron job to run once a day. </li>
  <li>If you want to add any documentation pages specific to your site to the Madrigal documentation pages, see the <a href="ad_other.html#siteSpecific">other admin tasks</a> section of this manual.</li>
  <li>If you want to add your own rules of the road to the Madrigal experiment page, see the <a href="ad_other.html#rules">other admin tasks</a> section of this manual.</li>
</ol>
<p> </p>
<h4><a name="edit" id="edit"></a>Editing the madrigal.cfg file </h4>
The madrigal.cfg file contains all the configuration information specific to your installation. This section discusses how to edit that file for each parameter.  The madrigal.cfg.template file contains examples of each parameter. 
<ul>
  <li>MADROOT - Madrigal root directory (absolute). This must be set as an environmental variable. </li>
  <li>MAD<b></b>SERVER - Web server for accessing Madrigal </li>
  <li>MAD<b></b>SERVERROOT - document virtual directory relative to MAD<b></b>SERVER. This directory should not allow files to be executed. </li>
  <li>MAD<b></b>SERVERCGI - script virtual directory relative to MAD<b></b>SERVER. The web server will need write permission in this directory. This directory should be set to execute only. </li>
  <li>MAD<b></b>SERVERDOCABS - Directory (absolute) where Madrigal documentation and images necessary for the Web software should be installed. You will need write permission to install files in this directory. You may need to be root to create this directory. </li>
  <li>MAD<b></b>SERVERCGIABS - Directory (absolute) where Madrigal  CGI scripts will be installed. You will need write permission to install files in this directory. You may need to be root to create this directory. </li>
  <li>SITEID - Site ID - Must be unique and same as in siteTab.txt </li>
  <li>HTMLSTYLE - Body style of html pages </li>
  <li>INDEXHEAD - Heading in the top-level Madrigal page </li>
  <li>CONTACT - Mailto link of contact person(s) for this madrigal installation. Multiple email addresses may be included if separated by commas. </li>
  <li>MAILSERVER - Name of mailserver (possibly localhost if running sendmail) </li>
  <li>NOTESMANAGER - If you want someone to be notified whenever a user adds a note to an experiment, uncomment this optional line and add the email address. See below for a discussion of the optional notes feature and how to configure it after installation. </li>
  <li>MAXGLOBALQUERIES - The maximum number of global queries you want to allow to run on your webserver at any one time. Since a global query can take minutes or even hours to run, setting this value will limit the number of these background jobs running on your webserver. Users who request a global query when the server is at this maximum already will get a message requesting them to resubmit the query later. </li>
  <li> MAXTEMPREPORTS - Sets the maximum size of the tempReports directory in GB. If not set, defaults to 2 GB. </li>
</ul>
<!-- InstanceEndEditable -->
<table width="100%" border="1" cellpadding="0" cellspacing="2" class="navigation">
  <tr>
    <td width="5%"><a href="ad_appropriate.html"><img src="icons/previous.png" alt="previous" width="32" height="32" /></a></td>
    <td width="5%"><a href="admin.html"><img src="icons/up.png" alt="up" width="32" height="32" /></a></td>
    <td width="5%"><a href="ad_upgrade.html"><img src="icons/next.png" alt="next" width="32" height="32" /></a></td>
    <td width="54%"><!-- InstanceBeginEditable name="EditTitleBottom" -->Installing Madrigal for the first time <!-- InstanceEndEditable --></td>
    <td width="13%"><a href="/MADSERVERROOT/madContents.html">Doc home </a></td>
    <td width="18%"><a href="/MADSERVERROOT">Madrigal home</a></td>
  </tr>
</table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" href="ad_appropriate.html"><!-- InstanceBeginEditable name="PreviousTitle2" -->Is Madrigal appropriate? <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Up:</b>
<a class="sectref" href="admin.html"><!-- InstanceBeginEditable name="UpTitle2" -->Madrigal admin guide <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Next:</b>
<a class="sectref" href="ad_upgrade.html"><!-- InstanceBeginEditable name="NextTitle2" -->Upgrading Madrigal <!-- InstanceEndEditable --></A></div>
<hr/>
<p>&nbsp;</p>
</body>
<!-- InstanceEnd --></html>
