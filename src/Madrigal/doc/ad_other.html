<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/doc_template.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Other administrative tasks</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" -->


<style type="text/css">
<!--
.style1 {font-family: "Courier New", Courier, monospace}
-->
</style>
<!-- InstanceEndEditable -->
<link href="madrigal.css" rel="stylesheet" type="text/css" />
<!-- InstanceParam name="href_up_top" type="text" value="admin.html" --><!-- InstanceParam name="href_next_top" type="text" value="ad_logging.html" --><!-- InstanceParam name="href_back_top" type="text" value="ad_createExp.html" --><!-- InstanceParam name="href_back_bottom" type="text" value="ad_createExp.html" --><!-- InstanceParam name="href_up_bottom" type="text" value="admin.html" --><!-- InstanceParam name="href_next_bottom" type="text" value="ad_logging.html" --><!-- InstanceParam name="href_prev_top" type="text" value="ad_createExp.html" --><!-- InstanceParam name="href_uptitle_top" type="text" value="admin.html" --><!-- InstanceParam name="href_nexttitle_top" type="text" value="ad_logging.html" --><!-- InstanceParam name="href_prevtitle_bottom" type="text" value="ad_createExp.html" --><!-- InstanceParam name="href_uptitle_bottom" type="text" value="admin.html" --><!-- InstanceParam name="href_nexttitle_bottom" type="text" value="ad_logging.html" -->
</head>

<body>
<table width="100%" border="1" cellpadding="0" cellspacing="2" class="navigation">
  <tr>
    <td width="5%"><a href="ad_createExp.html"><img src="icons/previous.png" alt="previous" width="32" height="32" /></a></td>
    <td width="5%"><a href="admin.html"><img src="icons/up.png" alt="up" width="32" height="32" /></a></td>
    <td width="5%"><a href="ad_logging.html"><img src="icons/next.png" alt="next" width="32" height="32" /></a></td>
    <td width="54%"><!-- InstanceBeginEditable name="EditTitleTop" -->Other administrative tasks <!-- InstanceEndEditable --></td>
    <td width="13%"><a href="/MADSERVERROOT/madContents.html">Doc home </a></td>
    <td width="18%"><a href="/MADSERVERROOT">Madrigal home</a></td>
  </tr>
</table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" href="ad_createExp.html"><!-- InstanceBeginEditable name="PreviousTitle" -->Creating Madrigal experiments <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Up:</b>
<a class="sectref" href="admin.html"><!-- InstanceBeginEditable name="UpTitle" -->Madrigal admin guide <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Next:</b>
<a class="sectref" href="ad_logging.html"><!-- InstanceBeginEditable name="NextTitle" -->User access logging  <!-- InstanceEndEditable --></A></div>
<hr/>
<!-- InstanceBeginEditable name="EditDoc" -->
<h1 align="center">Other administrative tasks</h1>
<p>Some other tasks a Madrigal administrator might need to do:</p>
<ul>
  <li><a href="#private">Set private versus public access for Madrigal data files</a></li>
  <li><a href="#links">Add site-specific links or text to the Madrigal homepage</a></li>
  <li><a href="#user_notes">Allow or disallow user-added notes to experiments</a></li>
  <li><a href="#madrigal_cfg">Modify settings in the madrigal.cfg file</a></li>
  <li><a href="#siteSpecific">Add documentation specific to your site to Madrigal documentation page</a></li>
  <li><a href="#rules">Add site-specific  rules-of the-road to the Madrigal experiment page</a></li>
  <li><a href="#copy_exp">Copy entire experiment directories from one Madrigal site to another</a></li>
  <li><a href="#updateExpTimes">Reset experiment start and end times according to data in the experiment files</a></li>
</ul>
<p>Contact the <a href="mailto:madrigal@haystack.mit.edu">OpenMadrigal administrator</a> <a href="mailto:brideout@haystack.mit.edu"></a> if some other administrative issue arises. </p>
<h4><a name="private" id="private"></a>Set private versus public access for Madrigal data files</h4>
<p>This new feature of Madrigal allows data files to be made either publicly available, or restricted to a limited set of IP address listed in a file. </p>
<p>To disable this feature and make all your data public, run the following from the $MADROOT directory: </p>
<pre>$MADROOT/bin/setAccess $MADROOT/experiments public </pre>
<p>To enable this feature, you must first create a file called "trustedIPs.txt" under MADROOT. This file should contain the IP addresses of hosts considered to be part of the private group, or partial IPs if whole sub-nets should be included. This file is not created during installation. Anyone whose browser's IP matches this list will be able to view files marked as private. For example, if trustedIPs.txt contains the line 132.197.*, any IP address that begins 132.197 will have private access. </p>
<p>Also, if the fileTab.txt file for that experiment can be overwritten by the web server, anyone whose browser's IP matches this list will be able to to change the access of any file between public and private from the madExperiments listing page. </p>
<p>To change a large number of experiments to be either public or private, run the following script from the $MADROOT directory: </p>
<pre>$MADROOT/bin/setAccess dirPath [public || private] </pre>
<p>where dirPath is the full path name of any directory in $MADROOT/experiments, and the second argument is either public or private. This script will set all experiments in dirPath and below to be public or private. </p>
<p>The access permission for any given file is set in the fileTab.txt file. See <a href="ad_metadata.html">metadata documentation </a> for details. </p>
<h4><a name="user_notes" id="user_notes"></a>Allow or disallow user-added notes to experiments</h4>

<h4><a name="links" id="links"></a>Add site-specific links or text to the Madrigal homepage</h4>
<p>If you want, you can now add some site-specific links or text to the Madrigal homepage on your site.  The html you add will appear under the <b>OpenMadrigal</b> link in the left column of the page.</p>
<p>To add html, simply create a file in the MADROOT directory called <i>siteIndex.html</i>.  This file should not contain any BODY, HEAD, or HTML tags - it should only contain html to be inserted.  If you want to integrate your links in with the list above it, make your links list items as in the example below:</p>
<pre>
&lt;LI&gt;&lt;A HREF="http://jro.igp.gob.pe/english/index.htm"&gt;Jicamarca staff&lt;/A&gt;&lt;/LI&gt;
&lt;LI&gt;&lt;A HREF="http://jro.igp.gob.pe/english/index.htm"&gt;Jicamarca news&lt;/A&gt;&lt;/LI&gt;
</pre>
<p>After the siteIndex.html file is ready, cd to MADROOT and run the following script to install it:</p>
<pre>tclsh configureHtml</pre>
<p>To make a change, simply edit siteIndex.html and rerun the script above.</p>

<h4><a name="user_notes" id="user_notes"></a>Allow or disallow user-added notes to experiments</h4>
<p>This  feature of Madrigal allows users to append notes from the madExperiments search results page. This feature is only enabled if the web-server has write permission in the particular MADROOT/experiments directory where the experiment data is located. To allow this feature for all data, set all directory permissions below MADROOT/experiments to be writable by the web server. To disallow this feature for all data, set all directory permissions below MADROOT/experiments to not be writable by the web server. </p>
<p>As mention under <a href="ad_install.html#edit">editing madrigal.cfg</a>, the NOTESMANAGER parameter allows a user to be notified each time a note is added. This parameter can be commented out if no notification is required. </p>
<h4><a name="madrigal_cfg" id="madrigal_cfg"></a>Modify settings in the madrigal.cfg file</h4>
<p>The following settings in the <em>madroot</em>/madrigal.cfg file can be modified at any time and the changes will take effect immediately:</p>
<ul>
  <li>CONTACT - Mailto link of contact person(s) for this madrigal installation. Multiple email addresses may be included if separated by commas. </li>
  <li>MAILSERVER - Name of mailserver (possibly localhost if running sendmail) </li>
  <li>NOTESMANAGER - If you want someone to be notified whenever a user adds a note to an experiment, uncomment this optional line and add the email address. See below for a discussion of the optional notes feature and how to configure it after installation. </li>
  <li>MAXGLOBALQUERIES - The maximum number of global queries you want to allow to run on your webserver at any one time. Since a global query can take minutes or even hours to run, setting this value will limit the number of these background jobs running on your webserver. Users who request a global query when the server is at this maximum already will get a message requesting them to resubmit the query later. </li>
  <li> MAXTEMPREPORTS - Sets the maximum size of the tempReports directory in GB. If not set, defaults to 2 GB. </li>
</ul>
<p>The following settings in the  <em>madroot</em>/madrigal.cfg file can be modified, but the script <em>madroot</em>/configureHtml must be run afterwards for the changes to take effect:</p>
<ul>
  <li>HTMLSTYLE - Body style of html pages </li>
  <li>INDEXHEAD - Heading in the top-level Madrigal page </li>
</ul>
<h4><a name="siteSpecific" id="siteSpecific"></a>Add documentation specific to your site to Madrigal documentation page</h4>
<p>If you want to add any documentation pages specific to your site to the Madrigal documentation pages, simply put them in the directory <em>madroot</em>/doc/siteSpecific. If you do not yet have  the file <em>madroot</em>/doc/siteSpecific.html, cp <em>madroot</em>/doc/siteSpecific_template.html to <em>madroot</em>/doc/siteSpecific.html<em>. </em>The edit <em>madroot</em>/doc/siteSpecific.html to contain links to your documents. These links will be in the form &quot;siteSpecific/&lt;your document name&gt;&quot;. </p>
<p>Run &quot; <span class="style1">tclsh configureHtml&quot;</span> from the madroot directory to install these modified files on your web server. </p>
<p>The <a href="siteSpecific.html">Site Specific Documentation</a> link on the main documentation page will then take users to your siteSpecific.html page. </p>
<h4><a name="rules" id="rules"></a>Add site-specific  rules-of the-road to the Madrigal experiment page</h4>
<p>By default, users see only the Cedar rules-of-the-road on the data access page when they first enter the Madrigal site. If you want your users to see rules-of the-road specific to your Madrigal site when the reach the Madrigal experiment page, simply create a text file with your rules called <strong>local_rules_of_the_road.txt</strong> in the <em>madroot</em> directory. </p>
<h4><a name="copy_exp" id="copy_exp"></a>Copy entire experiment directories from one Madrigal site to another</h4>
<p> If you want to copy data from one Madrigal site into yours (such as is done during the standard installation with the test data from Haystack) copy all the desired data from another Madrigal site into the appropriate directory in $MADROOT/experiments. Then follow these steps: </p>
<ol>
  <li>cd $MADROOT </li>
  <li>./configureExperiments </li>
  <li>$MADROOT/bin/updateMaster </li>
</ol>
<p>The script configureExperiments automatically edits the metadata files, changing the site id to your site id. </p>
<h4><a name="updateExpTimes" id="updateExpTimes"></a>Reset experiment start and end times according to data in the experiment files</h4>
<p>Sometimes the experiment start and end times in the metadata (the expTab.txt file) are manually edited, and do not match the start and end times of the data found in the files. The script updateExpTimes.py will examine the start and end times of all the files in an experiment, and set the experiment metadata start and end times to be the earliest and latest times found. Usage:</p>
<pre>$MADROOT/bin/updateExpTimes.py [experiment_directory]</pre>
<p>If optional argument <em>experiment_directory</em> given, then it will only update all experiments found in that directory. Default is to update the entire database. Only default or real time files are used to determine the times. Example:</p>
<pre>$MADROOT/bin/updateExpTimes.py $MADROOT/experiments/1998</pre>
<p>will update all experiment times for the year 1998.  </p>
<p>&nbsp; </p>
<!-- InstanceEndEditable -->
<table width="100%" border="1" cellpadding="0" cellspacing="2" class="navigation">
  <tr>
    <td width="5%"><a href="ad_createExp.html"><img src="icons/previous.png" alt="previous" width="32" height="32" /></a></td>
    <td width="5%"><a href="admin.html"><img src="icons/up.png" alt="up" width="32" height="32" /></a></td>
    <td width="5%"><a href="ad_logging.html"><img src="icons/next.png" alt="next" width="32" height="32" /></a></td>
    <td width="54%"><!-- InstanceBeginEditable name="EditTitleBottom" -->Other administrative tasks <!-- InstanceEndEditable --></td>
    <td width="13%"><a href="/MADSERVERROOT/madContents.html">Doc home </a></td>
    <td width="18%"><a href="/MADSERVERROOT">Madrigal home</a></td>
  </tr>
</table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" href="ad_createExp.html"><!-- InstanceBeginEditable name="PreviousTitle2" -->Creating Madrigal experiments <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Up:</b>
<a class="sectref" href="admin.html"><!-- InstanceBeginEditable name="UpTitle2" -->Madrigal admin guide <!-- InstanceEndEditable --></A>
<b class="navlabel">&nbsp;&nbsp;Next:</b>
<a class="sectref" href="ad_logging.html"><!-- InstanceBeginEditable name="NextTitle2" -->User access logging  <!-- InstanceEndEditable --></A></div>
<hr/>
<p>&nbsp;</p>
</body>
<!-- InstanceEnd --></html>
