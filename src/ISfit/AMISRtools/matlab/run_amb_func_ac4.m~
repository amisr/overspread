clear all;

bl=30e-6; % baud length (us)
L=0:4; % lags to compute
penv=[1 1 1 1 ;
    1 -1 1 1;
    1 1 -1 1;
    1 -1 -1 1;
    1 1 1 -1;
    1 -1 1 -1;
    1 1 -1 -1;
    1 -1 -1 -1;]; % pulse envelope
h=[1]; % impulse response

for aa=1:size(penv,1)
    [tau,R,W2dS,W2d]=amb_func(bl,L,penv(aa,:),h);
    W2dt(:,:,:,aa)=W
end
